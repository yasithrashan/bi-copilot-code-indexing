# Ballerina Code Expansion

**Query:** Add a new HTTP server to the current implementation.

---

## main.bal

Imports
```ballerina
import ballerina/http;
import ballerina/time;
import ballerina/uuid;
```

Configuration Variables
```ballerina
configurable int servicePort = 8080;
configurable string serviceName = "Bookstore API";
configurable int maxBooksPerPage = 10;
configurable boolean debugMode = false;
```

Module Level Variables
```ballerina
int totalRequests = 0;
time:Utc serviceStartTime = time:utcNow();
map<BookCategory> bookCategories = {};
map<Book> bookStore = {};
```

Services
```ballerina
service /bookstore on new http:Listener(servicePort) {
    // Existing bookstore service resources...
}

service /admin on new http:Listener(servicePort) {
    // Existing admin service resources...
}

// New HTTP server
service /newserver on new http:Listener(servicePort + 1) {
    // Add new resources for the new server here
}
```

Resources
```ballerina
resource function get health() returns map<string> {
    totalRequests += 1;
    return {"status": "UP", "service": serviceName};
}

resource function get stats() returns ServiceStats {
    totalRequests += 1;

    string startTimeString = time:utcToString(serviceStartTime);

    ServiceStats stats = {
        totalRequests: totalRequests,
        totalBooks: bookStore.length(),
        serviceStartTime: startTimeString,
        serviceName: serviceName,
        debugMode: debugMode
    };

    return stats;
}

resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
    totalRequests += 1;

    if category.categoryName.trim().length() == 0 {
        return http:BAD_REQUEST;
    }

    bookCategories[category.categoryId] = category;
    return http:CREATED;
}

resource function get categories() returns BookCategory[] {
    totalRequests += 1;
    return bookCategories.toArray();
}
```

---

*Code expansion generated from 8 relevant chunks across 1 files*
