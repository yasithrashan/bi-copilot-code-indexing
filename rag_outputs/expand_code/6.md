# Ballerina Code Expansion

**Query:** Add a new HTTP server to the current implementation.

---

Based on the provided code and the request to add a new HTTP server, here's the relevant expanded and organized Ballerina code:

## main.bal

### Imports

```ballerina
import ballerina/http;
import ballerina/time;
import ballerina/uuid;
```

### Configuration Variables

```ballerina
configurable int servicePort = 8080;
configurable string serviceName = "Bookstore API";
configurable int maxBooksPerPage = 10;
configurable boolean debugMode = false;
```

### Module Level Variables

```ballerina
int totalRequests = 0;
time:Utc serviceStartTime = time:utcNow();
map<BookCategory> bookCategories = {};
map<Book> bookStore = {};
```

### Services

```ballerina
service /bookstore on new http:Listener(servicePort) {
    // Existing bookstore service resources...
}

service /admin on new http:Listener(servicePort) {
    // Existing admin service resources...
}

// New HTTP server
service /newserver on new http:Listener(servicePort + 1) {
    // Add resources for the new server here
}
```

### Resources

```ballerina
// Example resource for the new server
resource function get greeting() returns string {
    return "Hello from the new server!";
}
```

### Matching Resources

```ballerina
// Existing resources from bookstore service
resource function get books(int page = 1, int 'limit = maxBooksPerPage) returns PaginatedBooks|http:InternalServerError {
    // Existing implementation...
}

resource function post books(@http:Payload BookRequest bookRequest) returns http:Created|http:BadRequest|http:InternalServerError {
    // Existing implementation...
}

// Existing resources from admin service
resource function get stats() returns ServiceStats {
    // Existing implementation...
}

resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
    // Existing implementation...
}
```

## types.bal

```ballerina
// Existing type definitions...

public type Book record {|
    string id;
    string title;
    string author;
    string isbn;
    decimal price;
    int quantity;
|};

public type BookRequest record {|
    string title;
    string author;
    string isbn;
    decimal price;
    int quantity;
|};

public type BookCategory record {|
    string categoryId;
    string categoryName;
    string description;
|};

public type ServiceStats record {|
    int totalRequests;
    int totalBooks;
    string serviceStartTime;
    string serviceName;
    boolean debugMode;
|};
```

---

*Code expansion generated from 8 relevant chunks across 1 files*
