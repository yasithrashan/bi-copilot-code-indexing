Looking at the existing code context, I can see there's already a category service with POST and GET operations for categories. The query asks to extend this service to support PUT (update) and DELETE operations for categories.

## Explanation

I'll extend the existing admin service by adding two new resource functions:

1. **PUT operation**: A `put` resource function that allows updating an existing category by its ID. It will:
   - Accept a category ID as a path parameter
   - Take the updated category data in the request body
   - Validate that the category exists (return 404 if not found)
   - Validate the category name is not empty (return 400 if invalid)
   - Update the category in the map and return 200 OK

2. **DELETE operation**: A `delete` resource function that allows removing a category by its ID. It will:
   - Accept a category ID as a path parameter
   - Check if the category exists (return 404 if not found)
   - Remove the category from the map and return 204 No Content

Both operations will maintain the existing pattern of incrementing the `totalRequests` counter and follow the same error handling approach as the existing endpoints. The implementation uses the HTTP client's `put` and `delete` functions as specified in the API documentation.

<code filename="main.bal">
```ballerina
import ballerina/http;

map<BookCategory> bookCategories = {};
int totalRequests = 0;
int servicePort = 8080;
string serviceName = "Category Service";

service /admin on new http:Listener(servicePort) {

    // Add book category
    resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
        totalRequests += 1;

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[category.categoryId] = category;
        return http:CREATED;
    }

    // Get all categories
    resource function get categories() returns BookCategory[] {
        totalRequests += 1;
        return bookCategories.toArray();
    }

    // Update an existing category
    resource function put categories/[string categoryId](@http:Payload BookCategory category) returns http:Ok|http:NotFound|http:BadRequest {
        totalRequests += 1;

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[categoryId] = category;
        return http:OK;
    }

    // Delete a category
    resource function delete categories/[string categoryId]() returns http:NoContent|http:NotFound {
        totalRequests += 1;

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        _ = bookCategories.remove(categoryId);
        return http:NO_CONTENT;
    }

    // Health check endpoint
    resource function get health() returns map<string> {
        totalRequests += 1;
        return {"status": "UP", "service": serviceName};
    }
}
```
</code>

<code filename="types.bal">
```ballerina
// Book category type
public type BookCategory record {|
    string categoryId;
    string categoryName;
    string description;
|};
```
</code>