# Ballerina Code Expansion

**Query:** Extend the category service to also support update and delete operations for categories.

---

Based on the user query and the relevant code chunks provided, I'll expand and organize the existing code to include update and delete operations for categories in the admin service. Here's the expanded code:

## Filename: main.bal

## Imports
```ballerina
import ballerina/http;
```

## Module Level Variables
```ballerina
map<BookCategory> bookCategories = {};
int totalRequests = 0;
```

## Services
```ballerina
service /admin on new http:Listener(servicePort) {
```

## Resources
```ballerina
    // Add book category
    resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
        totalRequests += 1;

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[category.categoryId] = category;
        return http:CREATED;
    }

    // Get all categories
    resource function get categories() returns BookCategory[] {
        totalRequests += 1;
        return bookCategories.toArray();
    }

    // Update an existing category
    resource function put categories/[string categoryId](@http:Payload BookCategory category) returns http:Ok|http:NotFound|http:BadRequest {
        totalRequests += 1;

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[categoryId] = category;
        return http:OK;
    }

    // Delete a category
    resource function delete categories/[string categoryId]() returns http:NoContent|http:NotFound {
        totalRequests += 1;

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        _ = bookCategories.remove(categoryId);
        return http:NO_CONTENT;
    }
```

## Matching Resources
```ballerina
    // Health check endpoint
    resource function get health() returns map<string> {
        totalRequests += 1;
        return {"status": "UP", "service": serviceName};
    }
```

## Filename: types.bal

```ballerina
// Book category type
public type BookCategory record {|
    string categoryId;
    string categoryName;
    string description;
|};
```

This expanded code includes the existing `post` and `get` operations for categories, and adds new `put` and `delete` operations to support updating and deleting categories. The code maintains the existing structure and naming conventions, and uses the same error handling and response patterns as the original code.

---
