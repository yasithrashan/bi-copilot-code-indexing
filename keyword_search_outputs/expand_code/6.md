# Ballerina Code Expansion

**Query:** Add a new HTTP server to the current implementation.

---

Based on the user query to add a new HTTP server to the current implementation, I'll expand and organize the relevant existing code from the source files. The code already contains two HTTP servers: `/bookstore` and `/admin`. I'll show how to add a third HTTP server following the same pattern.

## Filename: main.bal

## Imports
```ballerina
import ballerina/http;
import ballerina/time;
import ballerina/uuid;
```

## Configuration Variables
```ballerina
configurable int servicePort = 8080;
configurable string serviceName = "Bookstore API";
configurable int maxBooksPerPage = 10;
configurable boolean debugMode = false;
```

## Module Level Variables
```ballerina
int totalRequests = 0;
time:Utc serviceStartTime = time:utcNow();
map<BookCategory> bookCategories = {};
map<Book> bookStore = {};
```

## Services
```ballerina
// Existing HTTP service for bookstore
service /bookstore on new http:Listener(servicePort) {
    // ... existing resources ...
}

// Existing HTTP service for admin
service /admin on new http:Listener(servicePort) {
    // ... existing resources ...
}

// New HTTP service for additional functionality
service /newservice on new http:Listener(servicePort) {
    // New resources will be added here
}
```

## Resources
```ballerina
// Example resource for the new service
resource function get welcome() returns string {
    totalRequests += 1;
    return "Welcome to the new service!";
}
```

## Matching Resources
```ballerina
// Existing resource from /bookstore service
resource function get health() returns map<string> {
    totalRequests += 1;
    return {"status": "UP", "service": serviceName};
}

// Existing resource from /admin service
resource function get stats() returns ServiceStats {
    totalRequests += 1;

    string startTimeString = time:utcToString(serviceStartTime);

    ServiceStats stats = {
        totalRequests: totalRequests,
        totalBooks: bookStore.length(),
        serviceStartTime: startTimeString,
        serviceName: serviceName,
        debugMode: debugMode
    };

    return stats;
}
```

This expanded code shows how to add a new HTTP server to the current implementation by creating a new service `/newservice` that listens on the same port as the existing services. The new service can include its own resources, and it can also access the same module-level variables and configuration as the existing services.

Remember that in a real-world scenario, you might want to consider using different ports for different services or implementing more sophisticated routing if needed.

---
