## Query ID: 6
**Query:** Add a new HTTP server to the current implementation.

**Results:**

### Chunk 01
**Score:** 6.2863
**ID:** cb314be4490edd84

```ballerina
service /bookstore on new http:Listener(servicePort) {
```

### Chunk 02
**Score:** 6.2863
**ID:** bfef2311d087c6bd

```ballerina
service /admin on new http:Listener(servicePort) {
```

### Chunk 03
**Score:** 3.1641
**ID:** 9bb53b6dfe6fd8f6

```ballerina
resource function post books(@http:Payload BookRequest bookRequest) returns http:Created|http:BadRequest|http:InternalServerError {
        totalRequests += 1;

        Book|error validatedBook = validateAndFormatBook(bookRequest);
        if validatedBook is error {
            return http:BAD_REQUEST;
        }

        bookStore[validatedBook.id] = validatedBook;
        return http:CREATED;
    }
```

### Chunk 04
**Score:** 3.1071
**ID:** d5a7e3df8b825d89

```ballerina
resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
        totalRequests += 1;

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[category.categoryId] = category;
        return http:CREATED;
    }
```

### Chunk 05
**Score:** 0.8494
**ID:** 7bea3c31c37d9129

```ballerina
resource function post books/search(@http:Payload BookSearchCriteria searchCriteria) returns Book[]|http:InternalServerError {
        totalRequests += 1;

        Book[] allBooks = bookStore.toArray();
        Book[] filteredBooks = [];

        foreach Book book in allBooks {
            boolean matches = true;

            string? titleCriteria = searchCriteria.title;
            if titleCriteria is string {
                if !book.title.toLowerAscii().includes(titleCriteria.toLowerAscii()) {
                    matches = false;
                }
            }

            string? authorCriteria = searchCriteria.author;
            if authorCriteria is string && matches {
                if !book.author.toLowerAscii().includes(authorCriteria.toLowerAscii()) {
                    matches = false;
                }
            }

            string? isbnCriteria = searchCriteria.isbn;
            if isbnCriteria is string && matches {
                if !book.isbn.includes(isbnCriteria) {
                    matches = false;
                }
            }

            decimal? minPriceCriteria = searchCriteria.minPrice;
            if minPriceCriteria is decimal && matches {
                if book.price < minPriceCriteria {
                    matches = false;
                }
            }

            decimal? maxPriceCriteria = searchCriteria.maxPrice;
            if maxPriceCriteria is decimal && matches {
                if book.price > maxPriceCriteria {
                    matches = false;
                }
            }

            if matches {
                filteredBooks.push(book);
            }
        }

        return filteredBooks;
    }
```

