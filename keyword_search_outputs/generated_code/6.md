I'll help you add a new HTTP server to your existing implementation. Based on the provided context, you already have two HTTP services (`/bookstore` and `/admin`) running on the same port. I'll add a third HTTP service following the same pattern while integrating with the existing module-level variables and configuration.

## Explanation

The new HTTP server will be implemented as an additional service (`/analytics`) that listens on the same port as the existing services. This new service will provide analytics and reporting functionality that complements the existing bookstore and admin services. The service will:

1. Share the same HTTP listener port with existing services
2. Access the same module-level variables (totalRequests, serviceStartTime, bookStore, etc.)
3. Provide new resources for analytics functionality like request tracking, performance metrics, and usage reports
4. Follow the same error handling and response patterns as existing services

The new service will include resources for:
- Getting analytics summary
- Tracking service usage patterns  
- Providing performance metrics
- Generating usage reports

<code filename="main.bal">
```ballerina
import ballerina/http;
import ballerina/time;
import ballerina/uuid;

configurable int servicePort = 8080;
configurable string serviceName = "Bookstore API";
configurable int maxBooksPerPage = 10;
configurable boolean debugMode = false;

int totalRequests = 0;
time:Utc serviceStartTime = time:utcNow();
map<BookCategory> bookCategories = {};
map<Book> bookStore = {};

// Existing HTTP service for bookstore
service /bookstore on new http:Listener(servicePort) {
    
    resource function get health() returns map<string> {
        totalRequests += 1;
        return {"status": "UP", "service": serviceName};
    }

    resource function get books() returns Book[]|http:BadRequest {
        totalRequests += 1;
        return bookStore.toArray();
    }

    resource function post books(@http:Payload Book newBook) returns http:Created|http:BadRequest {
        totalRequests += 1;
        string bookId = uuid:createType4AsString();
        newBook.id = bookId;
        bookStore[bookId] = newBook;
        return http:CREATED;
    }

    resource function get books/[string bookId]() returns Book|http:NotFound {
        totalRequests += 1;
        Book? book = bookStore[bookId];
        if book is () {
            return http:NOT_FOUND;
        }
        return book;
    }
}

// Existing HTTP service for admin
service /admin on new http:Listener(servicePort) {
    
    resource function get stats() returns ServiceStats {
        totalRequests += 1;
        string startTimeString = time:utcToString(serviceStartTime);
        ServiceStats stats = {
            totalRequests: totalRequests,
            totalBooks: bookStore.length(),
            serviceStartTime: startTimeString,
            serviceName: serviceName,
            debugMode: debugMode
        };
        return stats;
    }

    resource function post reset() returns http:Ok {
        totalRequests = 0;
        bookStore.removeAll();
        bookCategories.removeAll();
        serviceStartTime = time:utcNow();
        return http:OK;
    }
}

// New HTTP service for analytics
service /analytics on new http:Listener(servicePort) {
    
    resource function get welcome() returns string {
        totalRequests += 1;
        return "Welcome to the Analytics Service!";
    }

    resource function get summary() returns AnalyticsSummary {
        totalRequests += 1;
        time:Utc currentTime = time:utcNow();
        decimal uptime = time:utcDiffSeconds(currentTime, serviceStartTime);
        
        AnalyticsSummary summary = {
            totalRequests: totalRequests,
            totalBooks: bookStore.length(),
            totalCategories: bookCategories.length(),
            uptimeSeconds: uptime,
            averageRequestsPerSecond: uptime > 0 ? <decimal>totalRequests / uptime : 0.0,
            serviceName: serviceName
        };
        return summary;
    }

    resource function get metrics() returns PerformanceMetrics {
        totalRequests += 1;
        time:Utc currentTime = time:utcNow();
        decimal uptime = time:utcDiffSeconds(currentTime, serviceStartTime);
        
        PerformanceMetrics metrics = {
            requestCount: totalRequests,
            uptimeHours: uptime / 3600,
            memoryUsage: calculateMemoryUsage(),
            requestsPerHour: uptime > 0 ? (<decimal>totalRequests * 3600) / uptime : 0.0
        };
        return metrics;
    }

    resource function get usage/report() returns UsageReport {
        totalRequests += 1;
        time:Utc currentTime = time:utcNow();
        string currentTimeString = time:utcToString(currentTime);
        string startTimeString = time:utcToString(serviceStartTime);
        
        UsageReport report = {
            reportGeneratedAt: currentTimeString,
            serviceStartTime: startTimeString,
            totalApiCalls: totalRequests,
            activeBooks: bookStore.length(),
            activeCategories: bookCategories.length(),
            debugModeEnabled: debugMode
        };
        return report;
    }

    resource function get health() returns map<string> {
        totalRequests += 1;
        return {
            "status": "UP", 
            "service": "Analytics Service",
            "uptime": time:utcDiffSeconds(time:utcNow(), serviceStartTime).toString()
        };
    }
}

function calculateMemoryUsage() returns decimal {
    // Simulate memory usage calculation based on stored data
    int bookMemory = bookStore.length() * 100; // Approximate bytes per book
    int categoryMemory = bookCategories.length() * 50; // Approximate bytes per category
    return <decimal>(bookMemory + categoryMemory);
}
```
</code>

<code filename="types.bal">
```ballerina
public type Book record {
    string id?;
    string title;
    string author;
    string isbn;
    decimal price;
    string category?;
};

public type BookCategory record {
    string id;
    string name;
    string description;
};

public type ServiceStats record {
    int totalRequests;
    int totalBooks;
    string serviceStartTime;
    string serviceName;
    boolean debugMode;
};

public type AnalyticsSummary record {
    int totalRequests;
    int totalBooks;
    int totalCategories;
    decimal uptimeSeconds;
    decimal averageRequestsPerSecond;
    string serviceName;
};

public type PerformanceMetrics record {
    int requestCount;
    decimal uptimeHours;
    decimal memoryUsage;
    decimal requestsPerHour;
};

public type UsageReport record {
    string reportGeneratedAt;
    string serviceStartTime;
    int totalApiCalls;
    int activeBooks;
    int activeCategories;
    boolean debugModeEnabled;
};
```
</code>