Looking at the existing code, I need to extend the category service to support PUT (update) and DELETE operations. The service already has POST (create) and GET (list) operations for categories. I'll add the missing functionality while maintaining the existing structure and error handling patterns.

For the update operation, I'll use the PUT method to update an existing category by ID. For the delete operation, I'll use the DELETE method to remove a category by ID. Both operations will follow REST conventions and return appropriate HTTP status codes.

<code filename="main.bal">
```ballerina
import ballerina/http;
import ballerina/time;
import ballerina/uuid;

configurable int servicePort = 8080;
configurable string serviceName = "Bookstore API";
configurable int maxBooksPerPage = 10;
configurable boolean debugMode = false;

int totalRequests = 0;
time:Utc serviceStartTime = time:utcNow();
map<BookCategory> bookCategories = {};

service /admin on new http:Listener(servicePort) {

    // Get service statistics
    resource function get stats() returns ServiceStats {
        totalRequests += 1;

        string startTimeString = time:utcToString(serviceStartTime);

        ServiceStats stats = {
            totalRequests: totalRequests,
            totalBooks: bookStore.length(),
            serviceStartTime: startTimeString,
            serviceName: serviceName,
            debugMode: debugMode
        };

        return stats;
    }

    // Add book category
    resource function post categories(@http:Payload BookCategory category) returns http:Created|http:BadRequest {
        totalRequests += 1;

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        bookCategories[category.categoryId] = category;
        return http:CREATED;
    }

    // Get all categories
    resource function get categories() returns BookCategory[] {
        totalRequests += 1;
        return bookCategories.toArray();
    }

    // Update book category
    resource function put categories/[string categoryId](@http:Payload BookCategory category) returns http:Ok|http:BadRequest|http:NotFound {
        totalRequests += 1;

        if category.categoryName.trim().length() == 0 {
            return http:BAD_REQUEST;
        }

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        // Ensure the category ID in the payload matches the path parameter
        BookCategory updatedCategory = {
            categoryId: categoryId,
            categoryName: category.categoryName,
            description: category.description
        };

        bookCategories[categoryId] = updatedCategory;
        return http:OK;
    }

    // Delete book category
    resource function delete categories/[string categoryId]() returns http:NoContent|http:NotFound {
        totalRequests += 1;

        if !bookCategories.hasKey(categoryId) {
            return http:NOT_FOUND;
        }

        BookCategory removedCategory = bookCategories.remove(categoryId);
        return http:NO_CONTENT;
    }
}
```
</code>